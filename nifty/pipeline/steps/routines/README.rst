Nat: I didn't have enough time to rewrite everything in a more Object-oriented way.
I kept some some of that scratch work in here.
